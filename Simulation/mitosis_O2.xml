<CompuCell3D>

  <Potts>
    <Dimensions x="100" y="100" z="100"/>
    <Steps>10000</Steps>
    <Temperature>25</Temperature>
    <NeighborOrder>2</NeighborOrder>
    <Boundary_x>NoFlux</Boundary_x>
    <Boundary_y>NoFlux</Boundary_y>
    <Boundary_z>NoFlux</Boundary_z>
  </Potts>

  <Plugin Name="CellType">
    <CellType TypeName="Medium"   TypeId="0"/>
    <CellType TypeName="Normoxic" TypeId="1"/>
    <CellType TypeName="Hypoxic"  TypeId="2"/>
    <CellType TypeName="Necrotic" TypeId="3"/>
  </Plugin>

  <Plugin Name="Volume">
    <VolumeEnergyParameters CellType="Normoxic" LambdaVolume="5.0" TargetVolume="35"/>
    <VolumeEnergyParameters CellType="Hypoxic"  LambdaVolume="5.0" TargetVolume="30"/>
    <VolumeEnergyParameters CellType="Necrotic" LambdaVolume="3.0" TargetVolume="25"/>
  </Plugin>

  <Plugin Name="Surface">
    <SurfaceEnergyParameters CellType="Normoxic" LambdaSurface="5.0" TargetSurface="40"/>
    <SurfaceEnergyParameters CellType="Hypoxic"  LambdaSurface="5.0" TargetSurface="38"/>
    <SurfaceEnergyParameters CellType="Necrotic" LambdaSurface="3.0" TargetSurface="36"/>
  </Plugin>

  <Plugin Name="Contact">
    <!-- SYMMETRIC contact energy matrix -->
    <Energy Type1="Medium"   Type2="Medium">0</Energy>
    
    <!-- Medium-Cell interactions -->
    <Energy Type1="Medium"   Type2="Normoxic">15</Energy>
    <Energy Type1="Medium"   Type2="Hypoxic">15</Energy>
    <Energy Type1="Medium"   Type2="Necrotic">2</Energy>
    
    <!-- Cell-Medium interactions (symmetric) -->
    <Energy Type1="Normoxic" Type2="Medium">15</Energy>
    <Energy Type1="Hypoxic"  Type2="Medium">15</Energy>
    <Energy Type1="Necrotic" Type2="Medium">2</Energy>
    
    <!-- Cell-Cell interactions (symmetric matrix) -->
    <Energy Type1="Normoxic" Type2="Normoxic">5</Energy>
    <Energy Type1="Hypoxic"  Type2="Hypoxic">10</Energy>
    <Energy Type1="Necrotic" Type2="Necrotic">2</Energy>
    
    <!-- Cross-type interactions (both directions) -->
    <Energy Type1="Normoxic" Type2="Hypoxic">10</Energy>
    <Energy Type1="Hypoxic"  Type2="Normoxic">10</Energy>
    
    <Energy Type1="Normoxic" Type2="Necrotic">6</Energy>
    <Energy Type1="Necrotic" Type2="Normoxic">6</Energy>
    
    <Energy Type1="Hypoxic"  Type2="Necrotic">6</Energy>
    <Energy Type1="Necrotic" Type2="Hypoxic">6</Energy>
  </Plugin>

  <Plugin Name="NeighborTracker"/>
  <Plugin Name="CenterOfMass"/>
  
  <Plugin Name="Chemotaxis">
    <ChemicalField Name="Oxygen" Source="DiffusionSolverFE">
      <ChemotaxisByType Type="Normoxic" Lambda="10.0"/>
      <ChemotaxisByType Type="Hypoxic" Lambda="15.0"/>
    </ChemicalField>
  </Plugin>

  <Steppable Type="DiffusionSolverFE">
    <DiffusionField Name="Oxygen">
      <DiffusionData>
        <FieldName>Oxygen</FieldName>
        <DiffusionConstant>0.1</DiffusionConstant>
        <DecayConstant>0.0</DecayConstant>
        <InitialConcentration>1.0</InitialConcentration>
      </DiffusionData>

      <SecretionData>
        <Uptake Type="Normoxic" MaxUptake="0.05" RelativeUptakeRate="0.02"/>
        <Uptake Type="Hypoxic"  MaxUptake="0.03" RelativeUptakeRate="0.015"/>
        <Uptake Type="Necrotic" MaxUptake="0.01" RelativeUptakeRate="0.005"/>
      </SecretionData>

      <BoundaryConditions>
        <Plane Axis="X">
          <ConstantValue PlanePosition="Min" Value="1.0"/>
          <ConstantValue PlanePosition="Max" Value="1.0"/>
        </Plane>
        <Plane Axis="Y">
          <ConstantValue PlanePosition="Min" Value="1.0"/>
          <ConstantValue PlanePosition="Max" Value="1.0"/>
        </Plane>
        <Plane Axis="Z">
          <ConstantValue PlanePosition="Min" Value="1.0"/>
          <ConstantValue PlanePosition="Max" Value="1.0"/>
        </Plane>
      </BoundaryConditions>
    </DiffusionField>
  </Steppable>

</CompuCell3D>